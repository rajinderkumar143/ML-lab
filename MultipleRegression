import numpy as np
from sklearn.datasets import load_diabetes
from sklearn.metrics import r2_score, mean_squared_error

# Load dataset
data = load_diabetes()

X = data.data
y = data.target

# Add bias column
ones = np.ones((X.shape[0], 1))
X_b = np.hstack((ones, X))

# Normal Equation using pseudo-inverse (safer for real datasets)
theta = np.linalg.pinv(X_b).dot(y)

print("Intercept (θ0):", theta[0])
print("Coefficients (θ1...θm):")
print(theta[1:])

# Predictions
y_pred = X_b.dot(theta)

# Evaluation
print("R2 Score:", r2_score(y, y_pred))
print("MSE:", mean_squared_error(y, y_pred))
